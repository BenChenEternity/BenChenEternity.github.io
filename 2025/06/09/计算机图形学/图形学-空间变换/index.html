<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">

	<!-- title -->
	
		<title>
			
				空间变换 |
					
						Note
		</title>

		<!-- keywords,description -->
		
					

								<!-- favicon -->
								
									<link rel="shortcut icon" href="/favicon.ico">
										


											<!-- search -->
											<script>
												var searchEngine = "";
												if (typeof searchEngine == "undefined" || searchEngine == null || searchEngine == "")
												{
													searchEngine = "https://www.google.com/search?q=";
												}
												var homeHost = "BenChenEternity.github.io";
												if (typeof homeHost == "undefined" || homeHost == null || homeHost == "")
												{
													homeHost = window.location.host;
												}
											</script>


											
<link rel="stylesheet" href="/css/main.css">

												
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

													
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

														
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


															
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>

																
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

																	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

																		
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

																			
<script src="/js/main.js"></script>


																				
																					
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

																						
<script src="https://cdn.jsdelivr.net/npm/valine@v1.5.1/dist/Valine.min.js"></script>

																							
																								
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
	<header id="header">
    <a id="title" href="/" class="logo">Note</a>

	<ul id="menu">
    
      <li class="menu-item">
        <a href="/about" class="menu-item-link">About</a>
      </li>
    

    

    

    
  
    
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="Press Enter to search">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										hexo
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/06/09/hexo/%E9%85%8D%E7%BD%AE/">
                     
										    初始化配置
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										计算机图形学
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/06/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/openGL%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/">
                     
										    openGL环境安装
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/2025/06/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/%E5%9B%BE%E5%BD%A2%E5%AD%A6-%E7%A9%BA%E9%97%B4%E5%8F%98%E6%8D%A2/">
                     
										    空间变换
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content" class="content">
		<h1 id="article-title">
	空间变换
</h1>

<!-- meta -->
<div class="article-meta">
	

	<span>NicolasDavout</span>
	<span>2025-06-09 10:30:23</span>

  <div id="article-categories">
    
		  <span>Categories：</span>
      
    

    
		    <span>Tags：</span>
        
    
  </div>

</div>

<!-- content -->
<div id="article-content">
	<h2 id="齐次坐标">齐次坐标</h2>
<p>为什么计算机图形学使用四维坐标 (w=1) 来表示三维点？</p>
<p>这是一个计算机图形学中非常基础且核心的概念。简单来说，将三维坐标
<code>(x, y, z)</code> 扩展成四维坐标 <code>(x, y, z, 1)</code>
是为了使用<strong>齐次坐标 (Homogeneous
Coordinates)</strong>。这样做主要有以下几个至关重要的原因：</p>
<h3 id="统一变换操作将加法平移转为乘法">1.
统一变换操作：将加法（平移）转为乘法</h3>
<p>在三维空间中，我们有三种基本的几何变换：</p>
<ul>
<li><p><strong>缩放
(Scaling)</strong>：是一种线性变换，可以通过矩阵乘法实现。 <span
class="math display">$$
  \begin{bmatrix} x' \\ y' \\ z' \end{bmatrix} = \begin{bmatrix} s_x
&amp; 0 &amp; 0 \\ 0 &amp; s_y &amp; 0 \\ 0 &amp; 0 &amp; s_z
\end{bmatrix} \begin{bmatrix} x \\ y \\ z \end{bmatrix}
  $$</span></p></li>
<li><p><strong>旋转
(Rotation)</strong>：也是一种线性变换，同样可以通过矩阵乘法实现。 <span
class="math display">$$
  \begin{bmatrix} x' \\ y' \\ z' \end{bmatrix} = \mathbf{R}
\begin{bmatrix} x \\ y \\ z \end{bmatrix}
  $$</span></p></li>
<li><p><strong>平移
(Translation)</strong>：它不是线性变换，而是一种仿射变换，需要通过<strong>向量加法</strong>来实现。
<span class="math display">$$
  \begin{bmatrix} x' \\ y' \\ z' \end{bmatrix} = \begin{bmatrix} x \\ y
\\ z \end{bmatrix} + \begin{bmatrix} t_x \\ t_y \\ t_z \end{bmatrix}
  $$</span></p></li>
</ul>
<p>问题在于，平移是加法，而缩放和旋转是乘法。这使得将一系列变换（例如，先缩放，再旋转，最后平移）组合成一个单一的操作变得非常困难和不优雅。</p>
<p><strong>齐次坐标的引入解决了这个问题。</strong> 通过增加一个
<code>w</code> 分量，我们可以用一个 4x4
的矩阵来表示平移，从而将加法操作统一为乘法操作。</p>
<p>一个三维点 <span
class="math inline"><em>P</em>(<em>x</em>, <em>y</em>, <em>z</em>)</span>
在齐次坐标中表示为 <span
class="math inline"><em>P</em><sup>′</sup>(<em>x</em>, <em>y</em>, <em>z</em>, 1)</span>。现在我们来看平移矩阵：
<span class="math display">$$
\mathbf{T} = \begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; t_x \\
0 &amp; 1 &amp; 0 &amp; t_y \\
0 &amp; 0 &amp; 1 &amp; t_z \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
$$</span> 用这个矩阵去乘以我们的齐次坐标点： <span
class="math display">$$
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; t_x \\
0 &amp; 1 &amp; 0 &amp; t_y \\
0 &amp; 0 &amp; 1 &amp; t_z \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix} x \\ y \\ z \\ 1 \end{bmatrix}
=
\begin{bmatrix} 1 \cdot x + 0 \cdot y + 0 \cdot z + t_x \cdot 1 \\ 0
\cdot x + 1 \cdot y + 0 \cdot z + t_y \cdot 1 \\ 0 \cdot x + 0 \cdot y +
1 \cdot z + t_z \cdot 1 \\ 0 \cdot x + 0 \cdot y + 0 \cdot z + 1 \cdot 1
\end{bmatrix}
=
\begin{bmatrix} x + t_x \\ y + t_y \\ z + t_z \\ 1 \end{bmatrix}
$$</span> 看，我们通过一次矩阵乘法就实现了平移的效果！</p>
<h3 id="组合多个变换">2. 组合多个变换</h3>
<p>由于所有的变换（缩放、旋转、平移）现在都可以用一个 4x4
矩阵的乘法来表示，我们可以将一系列的变换预先组合成一个单一的<strong>复合变换矩阵</strong>。</p>
<p>例如，如果一个顶点需要先缩放 <code>S</code>，然后旋转
<code>R</code>，最后平移 <code>T</code>，其最终位置 <code>P'</code>
的计算方式是： <span
class="math display"><em>P</em><sup>′</sup> = <em>T</em> ⋅ (<em>R</em> ⋅ (<em>S</em> ⋅ <em>P</em>))</span>
由于矩阵乘法满足结合律，我们可以预先计算出复合矩阵 <span
class="math display"><em>M</em> = <em>T</em> ⋅ <em>R</em>⋅</span>。然后，对于模型上的成千上万个顶点，我们只需要对每个顶点做一次矩阵乘法
<span
class="math display"><em>P</em><sup>′</sup> = <em>M</em> ⋅ <em>P</em></span>
即可。这极大地提高了图形渲染管线的计算效率。</p>
<h3 id="区分点和向量">3. 区分“点”和“向量”</h3>
<p>齐次坐标的第四个分量 <code>w</code>
还有一个非常巧妙的作用：区分<strong>点 (Point)</strong> 和<strong>向量
(Vector)</strong>。</p>
<ul>
<li><p><strong>点
(Point)</strong>：是空间中的一个位置。它应该受到平移变换的影响。因此，我们用
<code>w=1</code> 来表示一个点。 <span class="math display">$$
  P = \begin{bmatrix} x \\ y \\ z \\ 1 \end{bmatrix}
  $$</span></p></li>
<li><p><strong>向量
(Vector)</strong>：表示一个方向和大小，例如速度、法线或从 A 到 B
的位移。向量不应该受到平移变换的影响（无论你把一个模型移动到哪里，它的“向前”方向本身是不变的）。因此，我们用
<code>w=0</code> 来表示一个向量。 <span class="math display">$$
  V = \begin{bmatrix} v_x \\ v_y \\ v_z \\ 0 \end{bmatrix}
  $$</span></p></li>
</ul>
<p>现在我们用平移矩阵去乘以一个向量试试： <span class="math display">$$
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; t_x \\
0 &amp; 1 &amp; 0 &amp; t_y \\
0 &amp; 0 &amp; 1 &amp; t_z \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix} v_x \\ v_y \\ v_z \\ 0 \end{bmatrix}
=
\begin{bmatrix} v_x + t_x \cdot 0 \\ v_y + t_y \cdot 0 \\ v_z + t_z
\cdot 0 \\ 0 \end{bmatrix}
=
\begin{bmatrix} v_x \\ v_y \\ v_z \\ 0 \end{bmatrix}
$$</span> 结果表明，平移变换对 <code>w=0</code>
的向量没有任何影响，这完全符合几何直觉。而旋转和缩放变换则对点和向量都有效。</p>
<h3 id="实现透视投影">4. 实现透视投影</h3>
<p>在从 3D 场景渲染到 2D
屏幕的过程中，我们需要进行透视投影，即“近大远小”的效果。这个过程也严重依赖于齐次坐标的
<code>w</code> 分量。在投影变换之后，顶点的 <code>w</code> 分量将不再是
<code>1</code>，而是与其深度相关的一个值。最终在<strong>透视除法
(Perspective Divide)</strong> 阶段，我们会将坐标的 <code>x, y, z</code>
分量全部除以 <code>w</code> 分量，从而得到正确的、具有透视效果的 2D
屏幕坐标。</p>
<h3 id="总结">总结</h3>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 23%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr>
<th style="text-align: left;">w 的值</th>
<th style="text-align: left;">代表的几何意义</th>
<th style="text-align: left;">主要原因</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>w = 1</strong></td>
<td style="text-align: left;"><strong>三维空间中的一个点</strong></td>
<td
style="text-align: left;">为了让平移变换（加法）能统一成矩阵乘法，方便组合变换。</td>
</tr>
<tr>
<td style="text-align: left;"><strong>w = 0</strong></td>
<td style="text-align: left;"><strong>三维空间中的一个向量</strong></td>
<td
style="text-align: left;">为了让向量（如方向、法线）在平移变换中保持不变。</td>
</tr>
<tr>
<td style="text-align: left;"><strong>w ≠ 1 且 w ≠ 0</strong></td>
<td style="text-align: left;"><strong>透视投影后的点</strong></td>
<td
style="text-align: left;">是实现透视投影（近大远小效果）的关键步骤，最终会执行“透视除法”。</td>
</tr>
</tbody>
</table>
<p>因此，将第四维设为 <code>1</code>
是利用齐次坐标系强大功能的第一步，它为现代计算机图形学中高效、统一的变换管线奠定了数学基础。</p>
<h2 id="空间变换">空间变换</h2>
<p>在计算机图形学中，三维变换通过一个4x4的矩阵来表示，该矩阵与一个代表点或向量的4x1列向量（使用齐次坐标）相乘。一个点
<span
class="math inline"><em>P</em>(<em>x</em>, <em>y</em>, <em>z</em>)</span>
在齐次坐标中表示为 <span class="math inline">$P' = \begin{bmatrix} x \\
y \\ z \\ 1 \end{bmatrix}$</span>。变换后的点 <span
class="math inline"><em>P</em><sup>″</sup></span> 通过矩阵乘法 <span
class="math inline"><em>P</em><sup>″</sup> = <em>M</em> ⋅ <em>P</em><sup>′</sup></span>
计算得出。</p>
<h3 id="平移-translation">平移 (Translation)</h3>
<p>平移变换将物体沿一个或多个三维轴线移动。</p>
<ul>
<li><strong><span
class="math inline"><em>T</em>(<em>t</em><sub><em>x</em></sub>, <em>t</em><sub><em>y</em></sub>, <em>t</em><sub><em>z</em></sub>)</span></strong>
<span class="math display">$$
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; t_x \\
0 &amp; 1 &amp; 0 &amp; t_y \\
0 &amp; 0 &amp; 1 &amp; t_z \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
$$</span></li>
</ul>
<hr />
<h3 id="缩放-scaling">缩放 (Scaling)</h3>
<p>缩放变换改变物体的大小。它可以是均匀的（所有轴向缩放因子相同）或不均匀的。</p>
<ul>
<li><strong><span
class="math inline"><em>S</em>(<em>s</em><sub><em>x</em></sub>, <em>s</em><sub><em>y</em></sub>, <em>s</em><sub><em>z</em></sub>)</span></strong>
<span class="math display">$$
\begin{bmatrix}
s_x &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; s_y &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; s_z &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
$$</span></li>
</ul>
<hr />
<h3 id="旋转-rotation">旋转 (Rotation)</h3>
<p>旋转是围绕三维空间中的一个轴进行的。以下是围绕主轴（X, Y, Z）旋转
<span class="math inline"><em>θ</em></span> 角度的矩阵。</p>
<ul>
<li><p><strong>绕X轴旋转 <span
class="math inline"><em>R</em><sub><em>x</em></sub>(<em>θ</em>)</span></strong>
<span class="math display">$$
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \cos\theta &amp; -\sin\theta &amp; 0 \\
0 &amp; \sin\theta &amp; \cos\theta &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
$$</span></p></li>
<li><p><strong>绕Y轴旋转 <span
class="math inline"><em>R</em><sub><em>y</em></sub>(<em>θ</em>)</span></strong>
<span class="math display">$$
\begin{bmatrix}
\cos\theta &amp; 0 &amp; \sin\theta &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 \\
-\sin\theta &amp; 0 &amp; \cos\theta &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
$$</span></p></li>
<li><p><strong>绕Z轴旋转 <span
class="math inline"><em>R</em><sub><em>z</em></sub>(<em>θ</em>)</span></strong>
<span class="math display">$$
\begin{bmatrix}
\cos\theta &amp; -\sin\theta &amp; 0 &amp; 0 \\
\sin\theta &amp; \cos\theta &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
$$</span></p></li>
</ul>
<hr />
<h3 id="错切-shearing">错切 (Shearing)</h3>
<p>错切变换使物体的形状倾斜。一个轴上的坐标变化是其它坐标的线性函数。</p>
<ul>
<li><p><strong>沿X轴的错切 <span
class="math inline"><em>S</em><em>h</em><sub><em>x</em></sub>(<em>s</em><sub><em>y</em></sub>, <em>s</em><sub><em>z</em></sub>)</span></strong>
<span class="math display">$$
\begin{bmatrix}
1 &amp; s_y &amp; s_z &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
$$</span>
<em>更通用的错切矩阵是将一个轴的坐标添加到另外两个轴上。例如，将Y和Z坐标添加到X坐标上。</em></p></li>
<li><p><strong>通用错切矩阵</strong> <span class="math display">$$
\begin{bmatrix}
1 &amp; sh_{yx} &amp; sh_{zx} &amp; 0 \\
sh_{xy} &amp; 1 &amp; sh_{zy} &amp; 0 \\
sh_{xz} &amp; sh_{yz} &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
$$</span> <em>其中，<span
class="math inline"><em>s</em><em>h</em><sub><em>i</em><em>j</em></sub></span>
表示将 j 坐标的倍数加到 i 坐标上。</em></p></li>
</ul>
<hr />
<h3 id="变换的组合">变换的组合</h3>
<p>多个变换可以按顺序通过矩阵乘法组合成一个单一的变换矩阵。例如，先缩放、再旋转、最后平移的组合矩阵
<span class="math inline"><em>M</em></span> 为 <span
class="math inline"><em>M</em> = <em>T</em> ⋅ <em>R</em> ⋅ <em>S</em></span>。注意，矩阵乘法不满足交换律，因此变换的顺序至关重要。</p>

</div>

<!-- post-guide -->

    <div class="post-guide">
        <div class="item left">
            
              <a href="/2025/06/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/openGL%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  openGL环境安装
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/2025/06/09/hexo/%E9%85%8D%E7%BD%AE/">
                初始化配置
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>


<!-- comment - giscus -->


<!-- comment - valine -->


<script>
	
	
</script>

	</div>
	<div id="footer">
	<p>
	©<span id="footerYear-start"></span>-<span id="footerYear-end"></span>

	
	    <a href="/">NicolasDavout</a>
	
	
	
	<br>
	Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
	by <a href="//wujun.me" target="_blank">Wu Jun</a>
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>


<script type="text/javascript">
	document.getElementById('footerYear-start').innerHTML = new Date().getFullYear() + '';
</script>

<script type="text/javascript">
	document.getElementById('footerYear-end').innerHTML = new Date().getFullYear() + '';
</script>

    <script src='https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js'></script>
    <script>
      if (window.mermaid) {
        mermaid.initialize({theme: 'forest'});
      }
    </script>

	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>